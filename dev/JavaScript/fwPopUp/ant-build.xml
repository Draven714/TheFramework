<?xml version="1.0"?>
<!-- This file is included in specific build files (ie build-deploy.xml)-->
<project name="fwPopup :: build script">

	<path id="yuiCompressorPaths">
		<pathelement location="../../minifier/yuicompressor-2.4.2.jar"/>
		<pathelement location="../../minifier/yui-compressor-ant-task-0.5.jar"/>
	</path>

	<target name="init" depends="createTemp,compile_js,clean"/>

	<target name="define-yui-compressor">
		<taskdef name="yui-compressor" classname="net.noha.tools.ant.yuicompressor.tasks.YuiCompressorTask">
			<classpath refid="yuiCompressorPaths"/>
		</taskdef>
	</target>

	<target name="createTemp" depends="define-yui-compressor">
		<mkdir dir="temp"/>
	</target>

	<target name="clean" depends="createTemp" description="Removes the temp folder and leftover files.">
		<delete dir="temp"/>
	</target>

	<taskdef name="jscomp" classname="com.google.javascript.jscomp.ant.CompileTask" classpath="../../minifier/compiler.jar"/>


<!-- JavaScript -->
	<target name="concat_js">
		<property name="js_dir" location="js"/>
	<!-- Concatenate the header, modules, and plugins together. -->
		<concat destfile="${buildLocation}/fwPopup.big.js" fixlastline="yes" eol="lf" append="no">
			<header file="${js_dir}/header.js"></header>
			<filelist dir="${js_dir}">
				<file name="GlobalVariables.js"/>
				<file name="fwPopup.js"/>
			</filelist>
			<footer file="${js_dir}/footer.js"></footer>
		</concat>
	</target>


	<!-- Minify. -->
	<target name="compile_js" depends="concat_js">
		<jscomp compilationLevel="simple" debug="false" output="${buildLocation}/fwPopup.js">
			<sources dir="${buildLocation}">
				<file name="fwPopup.big.js"/>
			</sources>
		</jscomp>
	</target>
</project>