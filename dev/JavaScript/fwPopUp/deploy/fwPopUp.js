(function(b){function y(b,c){var b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),h=RegExp("[\\?&]"+b+"=([^&#]*)").exec(c);return null==h?"":h[1]}function Y(){var b=location.href,c=b.indexOf("#"+l)+1;return c?decodeURI(b.substring(c,b.length)):!1}function Z(){if(self.pageYOffset)return{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset};if(j.documentElement&&j.documentElement.scrollTop)return{scrollTop:j.documentElement.scrollTop,scrollLeft:j.documentElement.scrollLeft};if(j.body)return{scrollTop:j.body.scrollTop,
scrollLeft:j.body.scrollLeft}}var g=b.fwPopup={initialized:!1,version:"1.0.2"},l,j=document,t=b(window),f,R,S,c,T,$,z,A,h,E,x,U,B,C=t.height(),m=t.width(),H=null;b.fn.fwPopup=function(w){var P,Q;function aa(){c.social_tools?(facebook_like_link=c.social_tools.replace("{location_href}",encodeURIComponent(location.href)),c.markup=c.markup.replace("{social_buttons}",c.social_tools)):c.markup=c.markup.replace("{social_buttons}","");b("body").append(c.markup);h=b(".fwpHolder");E=b(".fwpTitle");B=b("div.overlay");
if(q&&c.overlay_gallery){k="";for(var a=0;a<d.length;a++){var e="",f=d[a];d[a].match(/\b(jpg|jpeg|png|gif)\b/gi)||(e="default",f="");k+='<li class="'+e+'"><a href="#"><img src="'+f+'" width="50" alt=""/></a></li>'}k=c.gallery_markup.replace(/{gallery}/g,k);h.find("#fwpFullRes").after(k);x=b(".fwpHolder .fwpGallery");U=x.find("li");x.find(".fwpArrow-next").click(function(){g.changeGalleryPage("next");g.stopSlideshow();return!1});x.find(".fwpArrow-previous").click(function(){g.changeGalleryPage("previous");
g.stopSlideshow();return!1});h.find(".fwpContent").hover(function(){h.find(".fwpGallery:not(.disabled)").fadeIn()},function(){h.find(".fwpGallery:not(.disabled)").fadeOut()});U.each(function(a){b(this).find("a").click(function(){g.changePage(a);g.stopSlideshow();return!1})})}c.slideshow&&(h.find(".fwpNav").prepend('<a href="#" class="fwp_play">Play</a>'),h.find(".fwpNav .fwp_play").click(function(){g.startSlideshow();return!1}));h.attr("class","fwpHolder "+c.theme);B.css({opacity:0,height:b(j).height(),
width:t.width()}).on("click",function(){c.modal||g.close()});b("a.button-close").on("click",function(){g.close();return!1});if(c.allow_expand)b("a.button-expand").on("click",function(){b(this).hasClass("button-expand")?(b(this).removeClass("button-expand").addClass("button-contract"),r=!1):(b(this).removeClass("button-contract").addClass("button-expand"),r=!0);ba(function(){g.open()});return!1});h.find(".fwpPrevious, .fwpNav .fwpArrow-previous").on("click",function(){g.changePage("previous");g.stopSlideshow();
return!1});h.find(".fwpNext, .fwpNav .fwpArrow-next").on("click",function(){g.changePage("next");g.stopSlideshow();return!1});V()}function ca(a){a=C/2+W.scrollTop-a/2;0>a&&(a=0);return a}function V(){if(r&&h){W=Z();var a=h.height(),b=h.width(),c=ca(a);a>C||h.css({top:c,left:m/2+W.scrollLeft-b/2})}}function s(a,b){var e=!1;da(a,b);imageWidth=a;imageHeight=b;if((A>m||z>C)&&r&&c.allow_resize&&!L){for(var e=!0,d=!1;!d;)A>m?(imageWidth=m-200,imageHeight=b/a*imageWidth):z>C?(imageHeight=C-200,imageWidth=
a/b*imageHeight):d=!0,z=imageHeight,A=imageWidth;(A>m||z>C)&&s(A,z);da(imageWidth,imageHeight)}return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),containerHeight:Math.floor(z),containerWidth:Math.floor(A)+2*c.horizontal_padding,contentHeight:Math.floor(T),contentWidth:Math.floor($),resized:e}}function da(a,e){var a=parseFloat(a),e=parseFloat(e),d=h.find(".fwpDetails");d.width(a);var f=parseFloat(d.css("marginTop"))+parseFloat(d.css("marginBottom")),d=d.clone().addClass(c.theme).width(a).appendTo(b("body")).css({position:"absolute",
top:-1E4}),f=f+d.height(),f=34>=f?36:f;d.remove();d=h.find(".fwpTitle");d.width(a);var g=parseFloat(d.css("marginTop"))+parseFloat(d.css("marginBottom")),d=d.clone().appendTo(b("body")).css({position:"absolute",top:-1E4}),g=g+d.height();d.remove();T=e+f;$=a;z=T+g+h.find(".fwpTop").height()+h.find(".fwpBottom").height();A=a}function X(a){return a.match(/youtube\.com\/watch/i)||a.match(/youtu\.be/i)?"youtube":a.match(/vimeo\.com/i)?"vimeo":a.match(/\b.mov\b/i)?"quicktime":a.match(/\b.swf\b/i)?"flash":
a.match(/\b.(mp3|ogg)\b/i)?(P="mpeg",Q="mp3",a.match(/\b.ogg\b/i)&&(P="ogg",Q="vorbis"),"audio"):a.match(/\biframe=true\b/i)?"iframe":a.match(/\bajax=true\b/i)?"ajax":a.match(/\bcustom=true\b/i)?"custom":"#"==a.substr(0,1)?"inline":"image"}function ba(a){h.find("#fwpFullRes object,#fwpFullRes embed").css({visibility:"hidden"});h.find(".fwpFade").fadeOut(c.animation_speed,function(){b(".fwpLoader").show();a()})}function M(){b(".fwpLoader").hide();var a=ca(f.containerHeight),K=c.animation_speed;E.fadeTo(K,
1);h.find(".fwpContent").animate({height:f.contentHeight,width:f.contentWidth},K);h.animate({top:a,left:0>m/2-f.containerWidth/2?0:m/2-f.containerWidth/2,width:f.containerWidth},K,function(){h.find(".fwpHoverContainer,#fullResImage").height(f.height).width(f.width);h.find(".fwpFade").fadeIn(K);q&&"image"==X(d[e])?h.find(".fwpHoverContainer").show():h.find(".fwpHoverContainer").hide();c.allow_expand&&(f.resized?b("a.button-expand,a.button-contract").show():b("a.button-expand").hide());c.autoplay_slideshow&&
(null===H&&!S)&&g.startSlideshow();c.changepicturecallback();S=!0});if(q&&c.overlay_gallery&&"image"==X(d[e])){a="facebook"==c.theme||"default"==c.theme?50:30;p=Math.floor((f.containerWidth-100-a)/N);p=p<d.length?p:d.length;F=Math.ceil(d.length/p)-1;0==F?(a=0,x.find(".fwpArrow-next,.fwpArrow-previous").hide()):x.find(".fwpArrow-next,.fwpArrow-previous").show();var k=p*N,l=d.length*N,n=Math.floor(e/p)<F?Math.floor(e/p):F;x.css("margin-left",-(k/2+a/2)).find("div:first").width(k+5).find("ul").width(l).find("li.selected").removeClass("selected");
g.changeGalleryPage(n);U.filter(":eq("+e+")").addClass("selected")}else h.find(".fwpContent").off("mouseenter mouseleave");w.ajaxcallback()}var v=0,G,q=!1,p,N=57,k="",I=this,O,d,L=!1,r=!0,W=Z(),e,J,F=0,w=jQuery.extend({hook:"data-popUp",hookWord:"fwPopup",animation_speed:"fast",ajaxcallback:function(){},slideshow:5E3,autoplay_slideshow:!1,opacity:0.8,show_title:!0,allow_resize:!0,allow_expand:!0,default_width:500,default_height:344,counter_separator_label:"/",theme:"default",horizontal_padding:20,
hideflash:!1,wmode:"opaque",autoplay:!0,modal:!1,deeplinking:!0,overlay_gallery:!0,overlay_gallery_max:30,keyboard_shortcuts:!0,changepicturecallback:function(){},callback:function(){},ie6_fallback:!0,markup:function(){var a=[];a.push('<div class="fwpHolder">');a.push('<div class="fwpTitle"></div>');a.push('<div class="fwpTop">');a.push('<div class="fwpLeft"></div>');a.push('<div class="fwpMiddle"></div>');a.push('<div class="fwpRight"></div>');a.push("</div>");a.push('<div class="fwpContainer">');
a.push('<div class="fwpLeft">');a.push('<div class="fwpRight">');a.push('<div class="fwpContent">');a.push('<div class="fwpLoader"></div>');a.push('<div class="fwpFade">');a.push('<a href="javascript:void(0)" class="button-expand" title="Expand the image">Expand</a>');a.push('<div class="fwpHoverContainer">');a.push('<a class="fwpNext" href="javascript:void(0)">next</a>');a.push('<a class="fwpPrevious" href="javascript:void(0)">previous</a>');a.push("</div>");a.push('<div id="fwpFullRes"></div>');
a.push('<div class="fwpDetails">');a.push('<div class="fwpNav">');a.push('<a href="javascript:void(0)" class="fwpArrow-previous">Previous</a>');a.push('<p class="currentTextHolder">0/0</p>');a.push('<a href="javascript:void(0)" class="fwpArrow-next">Next</a>');a.push("</div>");a.push('<p class="fwpDescription"></p>');a.push('<div class="fwpSocial">{social_buttons}</div>');a.push('<a class="button-close" href="javascript:void(0)">Close</a>');a.push("</div>");a.push("</div>");a.push("</div>");a.push("</div>");
a.push("</div>");a.push('<div class="fwpBottom">');a.push('<div class="fwpLeft"></div>');a.push('<div class="fwpMiddle"></div>');a.push('<div class="fwpRight"></div>');a.push("</div>");a.push("</div>");a.push("</div>");a.push('<div class="overlay"></div>');return a.join("")}(),audio_markup:'{image}<audio controls autoplay class="audioPlayback"><source src="{path}" type="audio/{type}" codec="{codec}"/></audio>',custom_markup:"",flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true"/><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',
gallery_markup:function(){var a=[];a.push('<div class="fwpGallery">');a.push('<a href="javascript:void(0)" class="fwpArrow-previous">Previous</a>');a.push("<div>");a.push("<ul>");a.push("{gallery}");a.push("</ul>");a.push("</div>");a.push('<a href="javascript:void(0)" class="fwpArrow-next">Next</a>');a.push("</div>");return a.join("")}(),iframe_markup:'<iframe src ="{path}" width="{width}" height="{height}" frameborder="no"></iframe>',image_markup:'<img id="fullResImage" src="{path}"/>',inline_markup:'<div class="fwpInline">{content}</div>',
quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="//www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/"></embed></object>',social_tools:'<div class="twitter"><a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="//platform.twitter.com/widgets.js"><\/script></div><div class="facebook"><iframe src="//www.facebook.com/plugins/like.php?locale=en_US&href={location_href}&amp;layout=button_count&amp;show_faces=true&amp;width=500&amp;action=like&amp;font&amp;colorscheme=light&amp;height=23" scrolling="no" frameborder="0" style="border:none; overflow:hidden;width:500px;height:23px;" allowTransparency="true"></iframe></div>'},
w);l=w.hookWord;t.off("resize.fwPopup").on("resize.fwPopup",function(){V();C=t.height();m=t.width();B&&B.height(b(j).height()).width(m)});if(w.keyboard_shortcuts)b(j).off("keydown.fwPopup").on("keydown.fwPopup",function(a){if(h&&h.is(":visible"))switch(a.keyCode){case 37:g.changePage("previous");a.preventDefault();break;case 39:g.changePage("next");a.preventDefault();break;case 27:c.modal||g.close(),a.preventDefault()}});g.initialize=function(){c=w;var a=c.hook;"default"==c.theme&&(c.horizontal_padding=
16);l=b(this).attr(a);d=(q=/\[(?:.*)\]/.exec(l))?jQuery.map(I,function(c){if(b(c).attr(a).indexOf(l)+1)return b(c).attr("href")}):b.makeArray(b(this).attr("href"));J=q?jQuery.map(I,function(c){if(b(c).attr(a).indexOf(l)+1)return b(valuen).find("img").attr("alt")?b(c).find("img").attr("alt"):""}):b.makeArray(b(this).find("img").attr("alt"));O=q?jQuery.map(I,function(c){if(b(c).attr(a).indexOf(l)+1)return b(c).data()?b(c).data():""}):b.makeArray(b(this).data());G=q?jQuery.map(I,function(c){if(b(c).attr(a).indexOf(l)+
1)return b(c).attr("title")?b(c).attr("title"):""}):b.makeArray(b(this).attr("title"));d.length>c.overlay_gallery_max&&(c.overlay_gallery=!1);e=jQuery.inArray(b(this).attr("href"),d);R=q?e:b("a["+a+"^='"+l+"']").index(b(this));aa(this);if(c.allow_resize)t.on("scroll.fwPopup",V);g.open();return!1};g.open=function(a,j,m,p){"undefined"==typeof c&&(c=w,d=b.makeArray(a),J=j?b.makeArray(j):b.makeArray(""),G=m?b.makeArray(m):b.makeArray(""),q=1<d.length,e=p?p:0,aa(a.target));c.hideflash&&b("object,embed,iframe[src*=youtube],iframe[src*=vimeo]").css({visibility:"hidden"});
1<b(d).size()?b(".fwpNav").show():b(".fwpNav").hide();b(".fwpLoader").show();c.deeplinking&&"undefined"!=typeof l&&(location.hash=l+"/"+R+"/");c.social_tools&&(a=c.social_tools.replace("{location_href}",encodeURIComponent(location.href)),h.find(".fwpSocial").html(a));E.is(":hidden")&&E.css("opacity",0).show();B.show().fadeTo(c.animation_speed,c.opacity);h.find(".currentTextHolder").text(e+1+c.counter_separator_label+b(d).size());"undefined"!=typeof G[e]&&""!=G[e]?h.find(".fwpDescription").show().html(unescape(G[e])):
h.find(".fwpDescription").hide();var n=parseFloat(y("width",d[e]))?y("width",d[e]):c.default_width.toString(),u=parseFloat(y("height",d[e]))?y("height",d[e]):c.default_height.toString();L=!1;u.indexOf("%")+1&&(u=parseFloat(t.height()*parseFloat(u)/100-150),L=!0);n.indexOf("%")+1&&(n=parseFloat(t.width()*parseFloat(n)/100-150),L=!0);h.fadeIn(function(){c.show_title&&""!=J[e]&&"undefined"!=typeof J[e]?E.html(unescape(J[e])):E.addClass("no_content").html("");var a=0,l=0;switch(X(d[e])){case "ajax":r=
!1;f=s(n,u);l=r=!0;b.get(d[e],function(a){k=c.inline_markup.replace(/{content}/g,a);h.find("#fwpFullRes")[0].innerHTML=k;M()});break;case "audio":a=new Image;a.onload=function(){var g=new Audio,i=O[e].image?'<img src="'+O[e].image+'" alt="Cover for '+G[e]+'"/>':"",j=c.audio_markup.replace(/{type}/g,P),j=j.replace(/{codec}/g,Q),j=j.replace(/{image}/g,i);h.find("#fwpFullRes")[0].innerHTML=j.replace(/{path}/g,d[e]);b(".fwpContainer audio").width(a.width);g.setAttribute("src",d[e]);g.load();f=s(a.width,
a.height+30);M()};a.src=O[e].image;break;case "custom":f=s(n,u);k=c.custom_markup;break;case "flash":f=s(n,u);var i=d[e],j=d[e],i=i.substring(d[e].indexOf("flashvars")+10,d[e].length),j=j.substring(0,j.indexOf("?"));k=c.flash_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{wmode}/g,c.wmode).replace(/{path}/g,j+"?"+i);break;case "iframe":f=s(n,u);i=d[e];i=i.substr(0,i.indexOf("iframe")-1);k=c.iframe_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{path}/g,
i);break;case "image":a=new Image;i=new Image;j=new Image;q&&e<b(d).size()-1&&(i.src=d[e+1]);q&&d[e-1]&&(j.src=d[e-1]);h.find("#fwpFullRes")[0].innerHTML=c.image_markup.replace(/{path}/g,d[e]);a.onload=function(){f=s(a.width,a.height);M()};a.onerror=function(){alert("Image cannot be loaded. Make sure the path is correct and image exist.");g.close()};a.src=d[e];break;case "inline":i=b(d[e]).clone().append('<br clear="all">').css({width:c.default_width}).wrapInner('<div id="fwpFullRes"><div class="fwpInline"></div></div>').appendTo(b("body")).show();
r=!1;f=s(b(i).width(),b(i).height());r=!0;b(i).remove();k=c.inline_markup.replace(/{content}/g,b(d[e]).html());break;case "quicktime":f=s(n,u);f.height+=15;f.contentHeight+=15;f.containerHeight+=15;k=c.quicktime_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{wmode}/g,c.wmode).replace(/{path}/g,d[e]).replace(/{autoplay}/g,c.autoplay);break;case "vimeo":f=s(n,u);movie="//player.vimeo.com/video/"+d[e].match(/http(s?):\/\/(www\.)?vimeo.com\/(\d+)/)[3]+"?title=0&byline=0&portrait=0";
c.autoplay&&(movie+="&autoplay=1;");vimeo_width=f.width+"/embed/?moog_width="+f.width;k=c.iframe_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,f.height).replace(/{path}/g,movie);break;case "youtube":f=s(n,u),i=y("v",d[e]),""==i&&(i=d[e].split("youtu.be/"),i=i[1],0<i.indexOf("?")&&(i=i.substr(0,i.indexOf("?"))),0<i.indexOf("&")&&(i=i.substr(0,i.indexOf("&")))),movie="//www.youtube.com/embed/"+i,y("rel",d[e])?movie+="?rel="+y("rel",d[e]):movie+="?rel=1",c.autoplay&&(movie+="&autoplay=1"),
k=c.iframe_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{wmode}/g,c.wmode).replace(/{path}/g,movie)}!a&&!l&&(h.find("#fwpFullRes")[0].innerHTML=k,M())});return!1};g.changePage=function(a){v=0;"previous"==a?(e--,0>e&&(e=b(d).size()-1)):"next"==a?(e++,e>b(d).size()-1&&(e=0)):e=a;R=e;r||(r=!0);c.allow_expand&&b(".button-contract").removeClass("button-contract").addClass("button-expand");ba(function(){g.open()})};g.changeGalleryPage=function(a){"next"==a?(v++,v>F&&(v=0)):
"previous"==a?(v--,0>v&&(v=F)):v=a;var a="next"==a||"previous"==a?c.animation_speed:0,b=v*p*N;x.find("ul").animate({left:-b},a)};g.startSlideshow=function(){null===H?(h.find(".fwp_play").off("click").removeClass("fwp_play").addClass("fwp_pause").click(function(){g.stopSlideshow();return!1}),H=setInterval(g.startSlideshow,c.slideshow)):g.changePage("next")};g.stopSlideshow=function(){h.find(".fwp_pause").off("click").removeClass("fwp_pause").addClass("fwp_play").click(function(){g.startSlideshow();
return!1});clearInterval(H);H=null};g.close=function(){if(!B.is(":animated")){g.stopSlideshow();h.stop().find("object,embed").css({visibility:"hidden"});var a=c.animation_speed;b("div.fwpHolder,div.fwpTitle,.fwpFade").fadeOut(a,function(){b(this).remove()});B.fadeOut(a,function(){c.hideflash&&b("object,embed,iframe[src*=youtube],iframe[src*=vimeo]").css({visibility:"visible"});b(this).remove();t.off("scroll.fwPopup");location.href.indexOf("#"+l)+1&&(location.hash=l);c.callback();r=!0;S=!1;c=void 0})}};
if(!g.initialized&&Y()){g.initialized=!0;var D=Y(),ea=D.substring(D.indexOf("/")+1,D.length-1),D=D.substring(0,D.indexOf("/"));setTimeout(function(){b("a["+w.hook+"^='"+D+"']:eq("+ea+")").trigger("click")},50)}return I.off("click.fwPopup").on("click.fwPopup",g.initialize)}})(jQuery);