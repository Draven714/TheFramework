(function(b){b.bsmSelect.plugins.sortable=function(a,c){if(!(this instanceof b.bsmSelect.plugins.sortable))return new b.bsmSelect.plugins.sortable(a,c);this.sortConfig=a;this.options=b.extend({},this.defaultOpt,c||{})};b.extend(b.bsmSelect.plugins.sortable.prototype,{defaultOpt:{listSortableClass:"bsmListSortable"},init:function(a){var c=b.extend({},this.options,a.options),d=b.extend({},this.sortConfig,{items:"."+c.listItemClass}),e=this;a.$list.addClass(c.listSortableClass).sortable(d);a.$original.bind("change", function(b,c){e.onChange.call(e,a,b,c)});a.$list.bind("sortupdate",function(b,c){e.onSort.call(e,a,b,c)})},onChange:function(a,b,d){d&&"add"==d.type&&!a.buildingSelect&&(d.option.detach()["top"==a.options.addItemTarget?"prependTo":"appendTo"](a.$original),a.$list.sortable("refresh"))},onSort:function(a,c,d){b("."+a.options.listItemClass,a.$list).each(function(){b(this).data("bsm-option").data("orig-option").detach().appendTo(a.$original)});a.triggerOriginalChange(b(d.item).data("bsm-option").data("orig-option"), "sort")}})})(jQuery);